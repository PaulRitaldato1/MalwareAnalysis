#pragma once

#include "../IFile.h"
#include <fstream>
#include <string>
#include <experimental/filesystem>

namespace fs = std::experimental::filesystem;

namespace Extractor
{
    
    namespace PE
    {

        class PEFile32 : public IFile
        {
            public:
                PEFile32(std::shared_ptr<std::ifstream> file, FileDesc desc) : m_fileHandle(file)
                {
                    //TODO: FILL OUT FILE WITH FILEDESC, DO NOT KEEP IT AROUND
                }

                PEFile32()
                {
                    m_fileHandle = nullptr;
                }

                std::shared_ptr<FeatureSet> extractFeatures();
                void setFeatures(FeatureSet featureSet) { m_featureSet = featureSet; }
                FeatureSet getFeatureSet() { return m_featureSet; }
            private:
                std::shared_ptr<std::ifstream> m_fileHandle;
        };

        class PEFile64 : public IFile
        {
            public:
                PEFile64() 
                {
                    m_fileHandle = nullptr;
                }
                PEFile64(std::shared_ptr<std::ifstream> file, FileDesc desc) : m_fileHandle(file)
                {}

                std::shared_ptr<FeatureSet> extractFeatures();
                void setFeatures(FeatureSet featureSet) { m_featureSet = featureSet; }
                FeatureSet getFeatureSet() { return m_featureSet; }

            private:
                std::shared_ptr<std::ifstream> m_fileHandle;
                
        };

    }

}