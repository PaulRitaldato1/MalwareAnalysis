#include "PEFile.h"

namespace Extractor
{
    namespace PE
    {
        PEFile32::extractFeatures()
        {
            if (!file.is_open())
                    {
                        throw std::runtime_error("PEFile.h: extracor::PE::PEFile::PEFile(std::string): Failed to open file " + filepath);
                    }
                    
                    DWORD filesize = fs::file_size(fs::path(filename));
                    char* fileData = new char(filesize); 

                    file.read(fileData, filesize);

                    dosHeader = (PIMAGE_DOS_HEADER)fileData;
                    imageNTHeaders = (PIMAGE_NT_HEADERS)((DWORD)fileData + dosHeader->e_lfanew);
                    DWORD sectionLocation = (DWORD)imageNTHeaders + sizeof(DWORD) + (DWORD)(sizeof(IMAGE_FILE_HEADER)) + (DWORD)imageNTHeaders->FileHeader.SizeOfOptionalHeader;
	                DWORD sectionSize = (DWORD)sizeof(IMAGE_SECTION_HEADER);
                    
                    DWORD importDirectoryRVA = imageNTHeaders->OptionalHeader.DataDirectory[1].VirtualAddress;
        }
    }
}